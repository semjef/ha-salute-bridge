# ha-salute-bridge

based on https://github.com/JanchEwgen/MQTT-SberGate

## Описание

Плагин обеспечивает возвожность управления устройствами из HomeAssistant при 
помощи голосового ассистента Салют от Сбер

## Подготовка

Зарегистрируйтесь в [studio](https://developers.sber.ru/studio/)

Далее жмём "Создать проект" -> Smart Home MQTT

Заходим в созданный проект и в разделе "Доступ к облаку умного дома Sber" вводим любое название,
например "my_homeassistant" и жмём "Получить данные для подключения"

Логин и пароль сохраняем для ввода в конфигурации аддона

"Пользовательский пароль" вводим в приложении Салют

## Установка

Аддон только для supervised версии HA

Для установки зайдите в 
Настройки -> Дополнения -> Магазин дополнений -> 
Репозитории (в выпадающем меню) -> Добавьте репозиторий https://github.com/semjef/ha-salute-bridge

В списке Дополнений появится SaluteBridge, зайдите в него и нажмите установить. 

Установка занимает около 5 минут

## Конфигурация

ha_api_url и ha_api_token оставьте пустыми

sd_mqtt_login и sd_mqtt_password заполняем данными из раздела "подготовка"

Все остальные поля оставляем стандартными

## Проброс устройств

После запуска в интерфейсе аддона нажимаем на "веб-интерфейс" и в нём будет список из 
доступных для проброса устройств, ставим галочки для нужных и теперь можем управлять ими голосом.

Список доступных для синхронизации типов устройств HA:
- light
- switch
- input_boolean
- script
- sensor (temperature)

Для light устройств, у которых в столбце "Атрибуты" есть brightness, можно включить чекбокс около поля brightness, 
тогда яркостью можно будет управлять через Салют

## Дополнительно

Если у вас не supervised версия установки, то вы можете запустить контейнер в докере или просто python скрипт. 

Cоздайте в папке ha-salute-bridge/data файл options.json из [options.local.json](ha-salute-bridge/data/options.local.json)

Заполните все поля конфигурации в т.ч. ha_api_url и ha_api_token

Запустите сборку докер контейнера командой `docker compose up -d`